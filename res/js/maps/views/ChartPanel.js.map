{"version":3,"sources":["views/ChartPanel.coffee"],"names":[],"mappings":"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","file":"../../views/ChartPanel.js","sourcesContent":["# ChartPanel starts here\nChartPanel = Backbone.View.extend {\n\ttagName: \"div\" # Div used for this view\n\n\tevents: { #none for now\n\t\t\"click button.close_chartPanel\": \"closeChartPanel\"\n\t\t\"click button.delete_chartPanel\": \"deleteTemplate\"\n\t\t\"click button.save_chartPanel\": \"saveTemplate\"\n\t\t\"click button.downloadReports\": \"downloadReports\"\n\t\t\"click .info-button\": \"showInfo\"\n\t\t\"click button.refresh_chartPanel\": \"updateSelections\"\n\t\t#\"click button#check\": \"fetchReport\"\n\t\t\"click button#close\": \"save_close\"\n\t\t\"click button#editReport\": \"editReport\"\n\t}\n\n\tinitialize: (options) ->\n\t\t_.bindAll this,'render','closeChartPanel','appendChart','createChartModels', 'show_hide', 'unrender', 'deleteTemplate', 'saveTemplate', 'changeReport_Title', 'downloadReports', 'showInfo', 'selectionChange', 'updateSelections', 'fetchReport', 'createNewReport', 'save_close', 'editReport'\n\t\t@parent = options.parent\n\t\t@chartSelectionModel = options.chartSelectionModel\n\t\t@superParent = options.superParent\n\t\t@model.bind('remove', this.unrender)\n\t\t# This contains all the charts. One panel is assigned to one collection\n\t\t@chartCollection = new poimapper.ChartCollection()\n\t\t# When left panel selection changes, @chartSelectionModel is changed my ChartView and refresh button pops up for each collection\n\t\t@listenTo(@chartSelectionModel, 'change:locations change:fromDate change:toDate change:users', _.debounce(@selectionChange, 1))\n\t\t# Whenever a model is added to the collection, ChartBox view is called to render charts through appendChart\n\t\t@chartCollection.bind 'add', @appendChart\n\t\t# Model Binding events\n\t\t@model.on(\"change:report_title\",@changeReport_Title)\n\n\n\t# FUNCTION: render() appends a specific panel depending whether it is a template or just a temp report\n\trender: () ->\n\t\tif @model.get(\"template\")\n\t\t\t@$el.append @panel_template({\n\t\t\t\t\"report_title\": @model.get(\"report_title\")\n\t\t\t\t\"report_id\": @model.get(\"template_data\").report_id\n\t\t\t\t\"template_class\": \"delete_chartPanel\"\n\t\t\t\t\"btn_class\": \"danger\"\n\t\t\t\t\"icon_class\": \"trash\"\n\t\t\t\t\"area_label\": \"Delete Template\"\n\t\t\t\t#\"form\": @model.get(\"template_data\").details.form + \"\t(\" + @model.get(\"data\").chart1.no_of_pois + \")\"\n\t\t\t})\n\t\telse\n\t\t\t@$el.append @panel_template({\n\t\t\t\t\"report_title\": @model.get(\"report_title\")\n\t\t\t\t\"report_id\": @model.get(\"report_id\")\n\t\t\t\t\"template_class\": \"save_chartPanel\"\n\t\t\t\t\"btn_class\": \"primary\"\n\t\t\t\t\"icon_class\": \"floppy-o\"\n\t\t\t\t\"area_label\": \"Save As Template\"\n\t\t\t})\n\t\t@$(\".refreshing\").hide()\n\t\t# If its a new chart\n\t\tif @model.get(\"newChart\")\n\t\t\t@$('.chartPanelOptions').hide()\n\t\t\t#@$('.content').append @newReport_template({})\n\t\t\t@$('.panel-body').prepend @createNewReport().render().$el\n\t\t\t@chartNew.newReport_setForm()\n\t\t\t#@$(\".content\").append(\"<div><br/><h6></h6><ul><li>Select the questions</li><li>Numerical questions require an X-axis parameter</li><li>Filters <i class='fa fa-filter'></i> like date, users and location are provided</li><li>Check appropriate Settings <i class='fa fa-cog'></i></li><li><h3> Click 'Render' to generate the report.</h3> </li><li>After finishing, click 'Done'.</li></ul></div>\")\n\n\t\t@$('.refresh_chartPanel').hide()\n\t\t#console.log \"New Report \", @model.toJSON()\n\t\treturn this\n\n\n\t#FUNCTION: createNewReport() creates a view for creating new Report\n\tcreateNewReport: () ->\n\t\t#console.log \"ChartPanel Model\", @model\n\t\t@chartNew = new poimapper.views.ChartNew(\n\t\t\tmodel: @model\n\t\t\tparent: this\n\t\t\tsuperParent: @superParent\n\t\t\tchartSelectionModel: @chartSelectionModel\n\t\t)\n\t\treturn @chartNew\n\n\n\t# FUNCTION:selectionChange Shows the refresh button whenever selection on left panel changes\n\tselectionChange: () ->\n\t\t@$('.refresh_chartPanel').show()\n\n\n\t# FUNCTION: createChartModels() creates models that are used bu ChartBox to create charts. All the cleaning and specifying datatype needs to be done within this function\n\tcreateChartModels: () ->\n\t\twhile model = @chartCollection.first()\n\t\t\tmodel.destroy()\n\t\t@$('.content').empty()\n\t\t@$('.refresh_chartPanel').hide()\n\t\t#console.log \"createChartModels,\", @model\n\t\t# If charts are separated by location\n\t\t@byLocation = parseInt(@model.get(\"template_data\").template_params.reportType)\n\t\t@locationArr = []\n\t\t# Combining numric charts into one if there are multiple numeric charts\n\t\tif @model.get(\"template_data\").template_params.combinenumericfields is \"1\"\n\t\t\tcdata={'bar':{'flag':false,'data':{}}}\n\t\t\ttemp_data = @model.get(\"data\")\n\t\t\t$.each temp_data, (key,value)=>\n\t\t\t\tif value.numeric and value.chart_type is \"bar\"\n\t\t\t\t\tunless cdata.bar.flag\n\t\t\t\t\t\tcdata.bar.data['title'] = \"Combined Numeric Fields\"\n\t\t\t\t\t\tcdata.bar.data['chart_type'] = \"bar\"\n\t\t\t\t\t\tcdata.bar.data['no_of_pois'] = value.no_of_pois\n\t\t\t\t\t\tcdata.bar.data['numeric'] = true\n\t\t\t\t\t\tcdata.bar.data['chart_variables']={}\n\t\t\t\t\t\tcdata.bar.flag=true\n\t\t\t\t\t$.each value.chart_variables, (key2, value2)=>\n\t\t\t\t\t\t#console.log \"cv\", key2\n\t\t\t\t\t\tcdata.bar.data.chart_variables[key2] = value2\n\t\t\t\t\tdelete temp_data[key]\n\t\t\t\n\t\t\tif cdata.bar.flag\n\t\t\t\ttemp_data['CombineNumericBar'] = cdata.bar.data\n\t\t\t\t@model.set data: temp_data\n\t\t\n\t\t$.each @model.get(\"data\"), (key,value)=>\n\t\t\t#console.log \"Key Value\", key, value\n\t\t\tif value.title == undefined || value.chart_type == undefined\n\t\t\t\treturn\n\n\t\t\ttitle= value.title\n\t\t\tlocation = if typeof value.location != 'undefined' then value.location else null\n\t\t\tfdata= []\n\t\t\tchartModel = new poimapper.models.ChartModel\n\t\t\tchartModel.set title: value.title\n\t\t\tchartModel.set chart_type: value.chart_type\n\t\t\tchartModel.set no_of_pois: value.no_of_pois\n\t\t\tchartModel.set numeric: if typeof value.numeric != 'undefined' then value.numeric else false\n\t\t\tchartModel.set location: location\n\n\t\t\tif value.chart_variables == undefined\n\t\t\t\tfdata.push {\"key\":\"NO DATA\", \"value\": \"0\"}\n\t\t\t\t\n\t\t\telse if chartModel.get(\"numeric\") is true and @model.get(\"template_data\").template_params.combinenumericfields is \"1\"\n\t\t\t\tfdata = value.chart_variables\n\t\t\t\tvalue.title = \"Combined Numeric Fields\"\n\t\t\t\tchartModel.set title: \"Combined Numeric Fields\"\n\t\t\t\t\t\t\n\t\t\telse\n\t\t\t\t$.each value.chart_variables, (key2,value2)=>\n\t\t\t\t\ttemp_key = key2.split(\"-&\")\n\n\t\t\t\t\tif temp_key.length is 2\n\t\t\t\t\t\tkey2 = temp_key[1]\n\t\t\t\t\t#console.log \"lala\", key2, temp_key\n\t\t\t\t\tfdata.push {\"key\":key2, \"value\": parseInt(value2)}\n\n\t\t\tchartModel.set chart_variables: fdata\n\n\t\t\t# Aggregating charts into one group if location\n\t\t\tif @byLocation == 1\n\t\t\t\tloc_title = value.title.replace(/[^A-Z0-9]+/ig, \"_\")\n\t\t\t\tchartModel.set loc_title: loc_title\n\t\t\t\tif @locationArr.indexOf(loc_title) == -1\n\t\t\t\t\t@locationArr.push(loc_title)\n\t\t\t\t\t@$('.content').append @location_template({\n\t\t\t\t\t\t\"title\": value.title\n\t\t\t\t\t\t\"class_id\": loc_title\n\t\t\t\t\t})\n\t\t\t\t#console.log \"keyvalue\", key, value\n\n\n\t\t\t@chartCollection.add chartModel\n\t\t#console.log \"createChartModels->\",@chartCollection.models\n\n\n\t# FUNCTION: appendChart() renders a chart whenever a new model is created\n\tappendChart:(chartModel) ->\n\t\t#console.log \"appendchart2\", chartModel\n\t\tchartBox = new poimapper.views.ChartBox(\n\t\t\tmodel : chartModel\n\t\t\tparent: this\n\t\t)\n\t\tif @byLocation == 1\n\t\t\tloc_title = chartModel.get(\"loc_title\")\n\t\t\t@$('.'+loc_title).append chartBox.render().el\n\t\telse\n\t\t\t@$('.content').append chartBox.render().el\n\t\tsetTimeout(()->\n\t\t\tchartBox.createChart()\n\t\t, 0)\n\n\n\n\t# FUNCTION: updateSelections() if refresh button is clicked, the new template_params are updated, and new url is created to fetch JSON data. The charts are then updated.\n\tupdateSelections:()->\n\t\tself = @\n\t\ttemp = @model.get(\"template_data\")\n\t\ttemp.template_params.locs = @chartSelectionModel.get(\"locations\")\n\t\ttemp.template_params.levels = @chartSelectionModel.get(\"levels\")\n\t\ttemp.template_params.users = @chartSelectionModel.get(\"users\")\n\t\ttemp.template_params.fromdate = @chartSelectionModel.get(\"fromDate\")\n\t\ttemp.template_params.todate = @chartSelectionModel.get(\"toDate\")\n\n\t\t@model.set template_data: temp\n\t\t@fetchReport(()->\n\t\t\t#console.log(\"Working\")\n\t\t\tself.createChartModels()\n\t\t)\n\n\n\t# FUNCTION: fetchReport() if refresh button is clicked, the new template_params are updated, and new url is created to fetch JSON data. The charts are then updated.\n\tfetchReport:(cb)->\n\t\t@$(\".refreshing\").show()\n\t\tkey = @superParent.key\n\t\tusername =\t@superParent.username\n\t\tuser_id =\t@superParent.user_id\n\t\tt_par = @model.get(\"template_data\").template_params #template_params are values used for regenerating url for fetching data\n\t\t\n\t\ttemplate_url = \"#{baseUrl}app/jasper/#{t_par.poi}/#{t_par.includelocation}/#{t_par.newdata}/#{t_par.chart}/#{t_par.type}?key=\" + key + \"&userid=\"+ username + \"&user_id=\"+ user_id + \"&questions=\" + t_par.questions + \"&locs=\" + t_par.locs + \"&levels=\" + t_par.levels + \"&users=\" + t_par.users + \"&fromdate=\" + t_par.fromdate + \"&todate=\" + t_par.todate + \"&timeinfo=\" + t_par.timeinfo + \"&userinfo=\" + t_par.userinfo + \"&legendid=\" + t_par.legendid + \"&reportType=\" + t_par.reportType + \"&locationLevels=\" + t_par.locationLevels + \"&combinenumericfields=\" + t_par.combinenumericfields + \"&timeseriestype=\" + t_par.timeseriestype + \"&locationLevelDataFilter=\" + t_par.locationLevelDataFilter + \"&orientation=\" + t_par.orientation + \"&rowquestionid=\" + t_par.rowquestionid + \"&groupid=\" + t_par.groupid + \"&format=json\" + \"&excludenull=\" + t_par.excludenull + \"&subgroup=\" + t_par.subgroup\n\t\t#template_url = \"#{baseUrl}app/jasper/#{t_par.poi}/#{t_par.includelocation}/#{t_par.newdata}/#{t_par.chart}/#{t_par.type}?key=\" + key + \"&userid=\"+ username + \"&user_id=\"+ user_id + \"&questions=\" + t_par.questions + \"&locs=\" + t_par.locs + \"&levels=\" + t_par.levels + \"&users=\" + t_par.users + \"&fromdate=\" + t_par.fromdate + \"&todate=\" + t_par.todate + \"&timeinfo=\" + t_par.timeinfo + \"&userinfo=\" + t_par.userinfo + \"&legendid=\" + t_par.legendid + \"&reportType=\" + t_par.reportType + \"&locationLevels=\" + t_par.locationLevels + \"&combinenumericfields=\" + 1 + \"&timeseriestype=\" + t_par.timeseriestype + \"&locationLevelDataFilter=\" + t_par.locationLevelDataFilter + \"&orientation=\" + t_par.orientation + \"&rowquestionid=\" + t_par.rowquestionid + \"&groupid=\" + t_par.groupid + \"&format=json\" + \"&excludenull=\" + t_par.excludenull + \"&subgroup=\" + t_par.subgroup\n\n\t\ttemplate_data = @model.get(\"template_data\")\n\t\ttemplate_data.url = template_url\n\t\t@model.set template_data: template_data\n\t\t#console.log \"fetchReport\", JSON.stringify(@model), template_url\n\n\t\tself = @\n\n\t\t$.ajax\n\t\t\t\ttype: \"GET\",\n\t\t\t\turl: template_url#self.model.get(\"template_data\").url,\n\t\t\t\tsuccess: (result) ->\n\n\t\t\t\t\tself.model.set data: result\n\t\t\t\t\tself.$(\".refreshing\").hide()\n\t\t\t\t\tconsole.log \"Refresh Data=\",JSON.stringify(self.model), template_url\n\t\t\t\t\t#self.createChartModels()\n\t\t\t\t\tif cb != null\n\t\t\t\t\t\tcb()\n\t\t\t\terror:(result) ->\n\t\t\t\t\tconsole.error \"Error occured in fetching Report\", error\n\t\t\t\t\t@$(\".refreshing\").hide()\n\t\t\t\t\tif cb != null\n\t\t\t\t\t\tcb()\n\n\t\tthis\n\n\n\t# FUNCTION: closeChartPanel() whenever cross(x) is clicked, it hides the panel by calling the parent-> ChartTab\n\tcloseChartPanel: ()->\n\t\t#console.log \"closepanel\", @parent\n\t\t@parent.change()\n\t\t#@model.destroy()\n\n\n\t# FUNCTION: unrender() removes the chartPanel whenever its model is destroyed/deleted. This happens only when reports are Templates\n\tunrender: () ->\n\t\t#console.log \"Model Destroyed\"\n\t\t@$el.remove()\n\n\n\t# FUNCTION: deleteTemplate() Deletes the templates permanently\n\tdeleteTemplate: () ->\n\t\tself = this\n\t\tbootbox.confirm \"Remove \" + @model.get(\"report_title\") + \" permanently from your report selections?\", (result)->\n\t\t\t#console.log 'Delete', result\n\t\t\tif result\n\t\t\t\t#console.log 'start deleting', self.model\n\t\t\t\t$.ajax\n\t\t\t\t\t\ttype: \"GET\"\n\t\t\t\t\t\turl: baseUrl + \"app/deletereport/\" + self.model.get(\"template_data\").report_id\n\t\t\t\t\t\theaders:\n\t\t\t\t\t\t\t\t\"Content-Type\": \"application/json\"\n\t\t\t\t\t\t\t\tuserid: self.superParent.username\n\t\t\t\t\t\t\t\tkey: self.superParent.key\n\t\t\t\t\t\tsuccess: (result) ->\n\t\t\t\t\t\t\t\tbootbox.alert result.message\n\t\t\t\t\t\t\t\tself.model.destroy()\n\n\n\t# FUNCTION: saveTemplate() Saves a temporary report as a Template\n\tsaveTemplate: () ->\n\t\t#console.log \"saveTemplate\", @model.get(\"template_data\")\n\t\tself = this\n\t\tbootbox.prompt({\n\t\t\ttitle: \"Save Report As\",\n\t\t\tvalue: @model.get(\"report_title\"),\n\t\t\tcallback: (result) ->\n\t\t\t\tif result != null\n\t\t\t\t\t#console.log \"Saving template\", result\n\t\t\t\t\tself.model.set report_title: result\n\t\t\t\t\tt_par = self.model.get(\"template_data\").template_params #template_params are values used for regenerating url for fetching data\n\t\t# Regenerating url before saving template\n\n\t\t\t\t\ttemplate_url = \"#{baseUrl}app/jasper/#{t_par.poi}/#{t_par.includelocation}/#{t_par.newdata}/#{t_par.chart}/#{t_par.type}?XXXquestions=\" + t_par.questions + \"&locs=\" + t_par.locs + \"&levels=\" + t_par.levels + \"&users=\" + t_par.users + \"&fromdate=\" + t_par.fromdate + \"&todate=\" + t_par.todate + \"&timeinfo=\" + t_par.timeinfo + \"&userinfo=\" + t_par.userinfo + \"&legendid=\" + t_par.legendid + \"&reportType=\" + t_par.reportType + \"&locationLevels=\" + t_par.locationLevels + \"&combinenumericfields=\" + t_par.combinenumericfields + \"&timeseriestype=\" + t_par.timeseriestype + \"&locationLevelDataFilter=\" + t_par.locationLevelDataFilter + \"&orientation=\" + t_par.orientation + \"&rowquestionid=\" + t_par.rowquestionid + \"&groupid=\" + t_par.groupid + \"&format=\" + t_par.format + \"&excludenull=\" + t_par.excludenull + \"&subgroup=\" + t_par.subgroup\n\n\t\t\t\t\tjson = \"{ \\\"report_name\\\" : \\\"\" + self.model.get(\"report_title\") + \"\\\" , \\\"parameters\\\" : \\\"\" + template_url + \"\\\"}\"\n\t\t\t\t\tconsole.log \"Saving REport Template\", json\n\t\t\t\t\t$.ajax\n\t\t\t\t\t\t\ttype: \"POST\"\n\t\t\t\t\t\t\tdata: json\n\t\t\t\t\t\t\turl: baseUrl + \"app/savereport\"\n\t\t\t\t\t\t\theaders:\n\t\t\t\t\t\t\t\t\t\"Content-Type\": \"application/json\"\n\t\t\t\t\t\t\t\t\tuserid: self.superParent.username\n\t\t\t\t\t\t\t\t\tkey: self.superParent.key\n\n\t\t\t\t\t\t\tsuccess: (result) ->\n\t\t\t\t\t\t\t\t\tt = result\n\t\t\t\t\t\t\t\t\tbootbox.alert t.message\n\t\t\t\t\t\t\t\t\t#console.log 'save message', result\n\t\t})\n\n\n\t# FUNCTION: changeReport_Title() Changes the name of report title in panel\n\tchangeReport_Title: () ->\n\t\t@$(\".report_title\").html @model.get(\"report_title\")\n\n\n\t# FUNCTION: show_hide() Shows or hides templates when li checkbox or cross is clicked\n\tshow_hide: ()->\n\t\tif !@model.get(\"checked\")\n\t\t\t@$el.hide()\n\t\telse\n\t\t\t@$el.show()\n\t\tthis\n\n\n\t# FUNCTION: showInfo() opens a bootbox to show info about the template/report\n\t# TODO add more details about the template\n\tshowInfo:() ->\n\t\tno_of_pois = 0\n\t\ttemp_data=@model.get(\"data\")\n\t\t###\n\t\tfor key of temp_data\n\t\t\tno_of_pois = temp_data[key].no_of_pois\n\t\t\tbreak\n\t\t###\n\t\tbootbox.dialog({\n\t\t\ttitle: \"Details\",\n\t\t\tmessage: '\n\t\t\t\t<ul>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<b>Form:</b>' + @model.get(\"template_data\").details.form + '\n\t\t\t\t\t</li>\n\t\t\t\t</ul>'\n\t\t})\n\n\n\t# FUNCTION: downloadReports() It is called whenever a report's pdf, excel, word needs to be downloaded as a file\n\tdownloadReports: (evt) ->\n\t\treport_type = $(evt.currentTarget).data('report_type')\n\t\tformat = 'pdf'\n\t\tswitch report_type\n\t\t\twhen 1\n\t\t\t\tformat = 'pdf'\n\t\t\twhen 2\n\t\t\t\tformat = 'docx'\n\t\t\twhen 3\n\t\t\t\tformat = 'xlsx'\n\t\t# Regenerating url before downloading\n\t\tkey = @superParent.key\n\t\tusername =\t@superParent.username\n\t\tuser_id =\t@superParent.user_id\n\t\tt_par = @model.get(\"template_data\").template_params #template_params are values used for regenerating url for fetching data\n\t\t#console.log 'auths', key, username, user_id\n\n\t\ttemplate_url = \"#{baseUrl}app/jasper/#{t_par.poi}/#{t_par.includelocation}/#{t_par.newdata}/#{t_par.chart}/#{t_par.type}?key=\" + key + \"&userid=\"+ username + \"&user_id=\"+ user_id + \"&questions=\" + t_par.questions + \"&locs=\" + t_par.locs + \"&levels=\" + t_par.levels + \"&users=\" + t_par.users + \"&fromdate=\" + t_par.fromdate + \"&todate=\" + t_par.todate + \"&timeinfo=\" + t_par.timeinfo + \"&userinfo=\" + t_par.userinfo + \"&legendid=\" + t_par.legendid + \"&reportType=\" + t_par.reportType + \"&locationLevels=\" + t_par.locationLevels + \"&combinenumericfields=\" + t_par.combinenumericfields + \"&timeseriestype=\" + t_par.timeseriestype + \"&locationLevelDataFilter=\" + t_par.locationLevelDataFilter + \"&orientation=\" + t_par.orientation + \"&rowquestionid=\" + t_par.rowquestionid + \"&groupid=\" + t_par.groupid + \"&format=\" + format + \"&excludenull=\" + t_par.excludenull + \"&subgroup=\" + t_par.subgroup\n\t\tconsole.log \"download\", template_url\n\t\tiframe = document.createElement 'iframe'\n\t\tiframe.height = 0\n\t\tiframe.width = 0\n\t\tiframe.src = template_url\n\t\treceiver = (evt) ->\n\t\t\t\tif evt.origin is window.location.origin and evt.data is \"no data\"\n\t\t\t\t\t\tbootbox.alert \"no data in report\"\n\n\t\tunless listenerAdded\n\t\t\t\twindow.addEventListener 'message', receiver, false\n\t\t\t\tlistenerAdded = true\n\n\t\t$(\"body\").append iframe\n\n\n\t# FUNCTION: save_close() Save and close @chartNew menu for creating new charts\n\tsave_close: () ->\n\t\tself = @\n\t\tconsole.log(\"done\")\n\t\tbootbox.confirm {\n\t\t\t\tmessage: 'Are you sure you are done editing the report?<br/> Proceed ',\n\t\t\t\tbuttons: {\n\t\t\t\t\t\tcancel: {\n\t\t\t\t\t\t\t\tlabel: 'Cancel',\n\t\t\t\t\t\t\t\tclassName: 'btn pull-left'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tconfirm: {\n\t\t\t\t\t\t\t\tlabel: 'Confirm',\n\t\t\t\t\t\t\t\tclassName: 'btn-success pull-right'\n\t\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcallback: (result)->\n\t\t\t\t\t\tif result\n\t\t\t\t\t\t\tself.chartNew.$el.hide()\n\t\t\t\t\t\t\tself.$('#menuOptions').append('<button type=\\\"button\\\" id=\"editReport\" class=\\\"btn btn-primary btn-sm chartPanelOptions\\\" data-report_type=\\\"1\\\" aria-label=\\\"Edit\\\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\\\"fa fa-pencil\\\"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>')\n\t\t\t\t\t\t\tself.$('.chartPanelOptions').show()\n\t\t}\n\n\n\teditReport: () ->\n\t\t@$('#editReport').remove()\n\t\t@$('.chartPanelOptions').hide()\n\t\t@chartNew.$el.show()\n\n\n\n\t# Function: templates used for this view\n\tpanel_template:_.template \"<div class='col-md-12 col-lg-12 col-sm-12'\tid=\\\"{{ report_id }}\\\"><div class=\\\"panel panel-primary\\\">\n\t\t\t\t\t\t\t<div class=\\\"panel-heading chartTitle\\\">\n\t\t\t\t\t\t\t\t<div class='row'>\n\t\t\t\t\t\t\t\t\t<div class='col-md-8'>\n\n\t\t\t\t\t\t\t\t\t\t\t<h4 class='report_title'>\n\t\t\t\t\t\t\t\t\t\t\t\t{{ report_title }}\n\n\t\t\t\t\t\t\t\t\t\t\t\t<i class=\\\"info-button fa fa-info-circle\\\" title=\\\"Additional Details\\\"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t<i class=\\'refreshing fa fa-circle-o-notch fa-spin\\'></i>\n\t\t\t\t\t\t\t\t\t\t\t</h4>\n\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class='col-md-4' id='menuOptions'>\n\t\t\t\t\t\t\t\t\t\t<button type=\\\"button\\\" class=\\\"close close_chartPanel\\\" aria-label=\\\"Close\\\">\n\t\t\t\t\t\t\t\t\t\t\t<i class=\\\"fa fa-times\\\"></i>\n\t\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t\t<button type=\\\"button\\\" class=\\\"btn btn-{{btn_class}} btn-sm {{template_class}} chartPanelOptions\\\" aria-label=\\\"{{area_label}}\\\">\n\t\t\t\t\t\t\t\t\t\t\t<i class=\\\"fa fa-{{icon_class}}\\\"></i>\n\t\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t\t<div class=\\\"btn-group chartPanelOptions\\\" role=\\\"group\\\" aria-label=\\\"Download Reports\\\">\n\t\t\t\t\t\t\t\t\t\t\t<button type=\\\"button\\\" class=\\\"btn btn-danger btn-sm downloadReports \\\" data-report_type=\\\"1\\\" aria-label=\\\"PDF\\\">\n\t\t\t\t\t\t\t\t\t\t\t\t<i class=\\\"fa fa-file-pdf-o pdf\\\"></i>\n\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t<button type=\\\"button\\\" class=\\\"btn btn-info btn-sm downloadReports\\\" data-report_type=\\\"2\\\" aria-label=\\\"Word\\\">\n\t\t\t\t\t\t\t\t\t\t\t\t<i class=\\\"fa fa-file-word-o word\\\"></i>\n\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t<button type=\\\"button\\\" class=\\\"btn btn-success btn-sm downloadReports \\\" data-report_type=\\\"3\\\" aria-label=\\\"Excel\\\">\n\t\t\t\t\t\t\t\t\t\t\t\t<i class=\\\"fa fa-file-excel-o excel\\\"></i>\n\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<button type=\\\"button\\\" class=\\\"btn btn-primary btn-sm refresh_chartPanel chartPanelOptions\\\" aria-label=\\\"Refresh\\\">\n\t\t\t\t\t\t\t\t\t\t\t\t<i class=\\\"fa fa-refresh\\\"></i>\n\t\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\\\"panel-body\\\">\n\t\t\t\t\t\t\t\t<div class=\\\"content\\\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div></div>\"\n\nlocation_template:_.template \"<div class='col-md-12 col-lg-12 col-sm-12'\\\"><div class=\\\"panel panel-info\\\">\n\t\t\t\t\t\t\t<div class=\\\"panel-heading chartTitle\\\">\n\t\t\t\t\t\t\t\t<h5 class='question_title'>\n\t\t\t\t\t\t\t\t\t<center><b>\n\t\t\t\t\t\t\t\t\t\t{{ title }}\n\t\t\t\t\t\t\t\t\t</center></b>\n\t\t\t\t\t\t\t\t</h5>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\\\"panel-body {{ class_id }}\\\"></div>\n\t\t\t\t\t\t</div></div>\"\n\n\n\n\n}\n# ChartPanel ends here\n\n# export the following globals\nroot = window or this\nunless root.poimapper?\n\troot.poimapper = {}\n\nunless root.poimapper.views?\n\troot.poimapper.views = {}\n\nroot.poimapper.views.ChartPanel = ChartPanel\n"]}